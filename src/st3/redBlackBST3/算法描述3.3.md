# 3.3平衡查找树
一种能够保证符号表API中所有操作（范围查找除外）均能够在对数时间内完成的数据结构。
## 1、2-3查找树
### 定义：
由2-结点（含有一个键和两个链接）和3-结点（含有两个键和三条链接）组成。完美平衡的2-3查找树：其所有空链接到根结点的距离都是相同的。
### 查找：
和二叉查找树的查找算法类似
### 插入新键：
1. #### 向2-结点中插入新键
   先进行查找，如果未命中的查找结束于一个2-结点，将其替换为一个3-结点即可。
2. #### 向一棵只含一个3-结点的树中插入新键 
   * 临时将新键存入3-结点，使之成为一个4-结点。
   * 将4-结点转换为一棵由3个2-结点组成的2-3树。
3. #### 向一个父结点为2-结点的3-结点中插入新键
   * 临时将新键存入3-结点，使之成为一个4-结点。
   * 将4-结点中的中键上移至父结点，左右两键分裂为两个新的2-结点。中键的左右两个链接分别指向两个新的2-结点。
4. #### 向一个父结点为3-结点的3-结点中插入新键。
   * 采用（3）的方式：构造临时4-结点，然后分解插入父结点。
   * 一直不断分解上插，直到遇到一个2-结点。
   * 或者一路全是3-结点，这样就把根结点变为4-结点。
5. #### 分解根结点
   * 分解4-结点的根结点，可采用（2）的方式，将根结点分解为3个2-结点。
### 2-3树的变换为局部变换
  * 2-3树插入算法的根本在于这些变换都是局部的：除了相关的结点和链接之外不必修改或检查树的其他部分。
  * 每次变换中，变更的链接数量不会超过一个很小的常数。
### 全局性质
  * 2-3树是向上生长的。
  * 所有局部变换都不会影响整个树的有序性和平衡性。
  * 只有当根结点分解为3个2-结点时，所有路径长度才会加1.
---
> ## 命题F： 在一棵大小为N的2-3树中，查找和插入操作访问的结点必然不超过lg*N*个。
---
## 2、红黑二叉查找树
```2-3查找树的一种实现。```
- ### 1）基本定义
  - #### 基本思想：
    用标准的二叉查找树（完全由2- 结点构成） 和一些额外的信息（替换3- 结点）来表示2-3树。
  - #### 两种类型的链接：
    - 红链接：左斜相连的两个2- 结点，构成一个3- 结点。
    - 黑链接：普通2- 结点连接。
- ### 2）另一种等价的定义
  #### 含有红黑链接并满足下列条件的二叉查找树：
    - 红链接均为左链接
    - 没胡任何一个结点同时和两条红链接相连
    - 该树是**完美黑色平衡**的， 即任意空链接到根结点的路径上的黑链接数量相同。
- ### 3）红黑颜色表示
  - #### 结点的颜色指的是指向该结点的链接的颜色
  - #### 颜色保存在Node的布尔变量color中。红色为true, 黑色为false.
  - #### 约定空链接为黑色。
  - #### 使用私有方法isRed()来测试结点颜色。

- ### 4）旋转
  - #### 左旋转
    将红色右链接转化为左链接。对应方法参数为：红色右链接的结点；返回：旋转后的新的子树根结点
  - #### 右旋转
    方法完全相同，只不过将left换成right即可。

- ### 5）插入操作
  - #### 向2- 结点插入新键
    新键<老键：直接新增一个红色左链接
    新键>老键：新增一个红色右链接，然后旋转。

  - ### 向一棵双键树（即一个 3- 结点）中插入新键
    有三种子情况，每种子情况都会产生一个同时连接到两条红链接的结点（4-结点的中间结点）。
    - #### 新键 > 双键：新键连接到3-结点的右链接，成为一个有两条红链接的4-结点
    - #### 新键 < 双键：新键连接到最左边的空链接，形成两条连续的左斜红链接，只需将上层红链接右旋即可。
    - #### 新键介于双键之间：会产生一条左斜红链接接一条右斜红链接，只需将下层红链接右旋即可。
    总的来说，分别通过0次、1次和2次旋转以及颜色变化得到期望的结果。

- ### 6）颜色转换
  用方法flipColors()来转换一个结点的两个红色子结点的颜色。除将子结点的颜色由红变黑外，同时还将父结点的颜色由黑变红。此变换为局部变换，不会影响整棵树的黑色平衡性。

- ### 根结点总是黑色

- ### 向树底部的 3- 结点插入新键

- ### 将红链接在树中向上传递

